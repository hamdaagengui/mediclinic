
function fn_signUp(){var e=document.forms["appmentSignUp"].elements;if(e['password'].value!=e['repassword'].value){alert("Passwords entered in the two fields are not same. Please enter it again.");e['repassword'].value="";e['password'].value="";}else{document.forms["appmentSignUp"].submit();}}
function fn_login(){document.forms["appMentlogin"].submit();}
function fn_showType(){var menuStyle=document.getElementById("TypeForm").style;menuStyle.display="block";}
function fn_showPatientRgFrm(){document.getElementById("Doctor").disabled=true;var menuStyle=document.getElementById("RegistrationForm").style;document.getElementById("PersonType").value="Patient";menuStyle.display="block";document.getElementById("hRegisterMe").value="Y";document.getElementById("username").value="";document.getElementById("password").value="";document.getElementById("LoginButton").disabled=true;document.getElementById("username").disabled=true;document.getElementById("password").disabled=true;document.getElementById("PersonType").disabled=true;}
function fn_hidePatientRgFrm(){var menuStyle=document.getElementById("RegistrationForm").style;menuStyle.display="none";document.getElementById("hRegisterMe").value="N";}
function fn_showDoctorRgFrm(){document.getElementById("Patient").disabled=true;document.getElementById("PersonType").value="Doctor";var menuStyle=document.getElementById("RegistrationForm").style;menuStyle.display="block";document.getElementById("hRegisterMe").value="Y";document.getElementById("username").value="";document.getElementById("password").value="";document.getElementById("LoginButton").disabled=true;document.getElementById("username").disabled=true;document.getElementById("password").disabled=true;document.getElementById("PersonType").disabled=true;}
function fn_hideDoctorRgFrm(){var menuStyle=document.getElementById("RegistrationForm").style;menuStyle.display="none";document.getElementById("hRegisterMe").value="N";}
function fn_showMessage(){document.getElementById("username").value="";document.getElementById("password").value="";document.getElementById("hPersonType").value=document.getElementById("PersonType").value;document.forms["logon"].submit();}
function fn_submitLogin(){document.getElementById('hPersonType').value=document.getElementById('PersonType').value;}
function fn_nextURL(URL){window.location.href=URL;}
function fn_searchDoctor(){if(CkDate(document.getElementById('searchCriteria.dateOfAppointment'),'mm/dd/yyyy')){document.forms["searchDoctor"].submit();}}
function CkDate(obj,format){if(typeof(obj)=='string')obj=document.myform[obj];var date=obj.value.split('/');var mydate=new Date(date[2],date[(format.charAt(0)=='d')?1:0]-1,date[(format.charAt(0)=='d')?0:1]);if(mydate<new Date().setHours(0,0,0,0)){alert('Date cannot be past date.');return false;}
return true;}
function CkDateValue(obj,format){var date=obj.split('/');var mydate=new Date(date[2],date[(format.charAt(0)=='d')?1:0]-1,date[(format.charAt(0)=='d')?0:1]);if(mydate<new Date().setHours(0,0,0,0)){alert('Date cannot be past date.');return false;}
return true;}
function fn_dayAppointment(personID,userName){window.location.href="/dayAppointment.htm?PersonID="+personID+"&AppointmentDate="+document.getElementById('searchCriteria.dateOfAppointment').value+"&UserName="+userName+"&TakeAppointment=Y";}
function fn_createAppointment(personID,doctorID,timeOfAppointment,appointmentDate,userName,doctorPersonID){if(CkDateValue(appointmentDate,'mm/dd/yyyy')){if(userName!=""){window.name="Parent";var WinSettings='help:0;center:yes;resizable:yes;dialogHeight:400px;dialogWidth:630px;status:no;edge:sunken';var c=window.showModalDialog('/createAppointment.htm?PersonID='+personID+"&DoctorID="+doctorID+"&AppointmentDate="+appointmentDate+"&AppointmentTime="+timeOfAppointment+"&UserName="+userName+"&DoctorPersonID="+doctorPersonID,window,WinSettings);}else{alert("We are sorry, there seems to be some issue with the appmate profile with whom you are trying to take appointment.");}}}
var firstSubmit=0;function fn_addAppointment(){document.getElementById('dateOfAppointment').disabled=false;document.getElementById('timeOfAppointment').disabled=false;document.forms['createAppointment'].target="Parent";if(firstSubmit==0){document.forms['createAppointment'].method="post";document.forms["createAppointment"].submit();firstSubmit=1;setTimeout(fn_addAppointment,2000);}else{document.forms['createAppointment'].method="post";document.forms['createAppointment'].action="dayAppointment.htm";document.forms['createAppointment'].submit();firstSubmit=0;self.close();}}
function fn_rescheduleAppointmentDate(){document.getElementById('dateOfAppointment').disabled=false;document.getElementById('timeOfAppointment').disabled=false;document.forms['rescheduleAppointment'].target="Parent";if(firstSubmit==0){document.forms['rescheduleAppointment'].method="post";document.forms["rescheduleAppointment"].submit();firstSubmit=1;setTimeout(fn_rescheduleAppointmentDate,2000);}else{document.forms['rescheduleAppointment'].method="post";document.forms['rescheduleAppointment'].action="dayAppointment.htm";document.forms['rescheduleAppointment'].submit();firstSubmit=0;self.close();}}
function fn_GetDayAppointment(indicator){var date=new Date(document.getElementById('AppointmentDate').value);window.name="mySelf";document.forms['rescheduleAppointment'].target="mySelf";var currentMonth=date.getMonth()+1;if(indicator==1){var nextDay=date.getDate()-1;document.getElementById('AppointmentDate').value=currentMonth+"/"+nextDay+"/"+date.getFullYear();}
if(indicator==2){var nextDay=date.getDate()+1;document.getElementById('AppointmentDate').value=currentMonth+"/"+nextDay+"/"+date.getFullYear();}
document.forms['rescheduleAppointment'].method="get";document.forms["rescheduleAppointment"].submit();}
function fn_GetMonthAppointment(indicator){var date=new Date(document.getElementById('AppointmentDate').value);window.name="mySelf";document.forms['rescheduleAppointment'].target="mySelf";if(indicator==1){document.getElementById('AppointmentDate').value=date.getMonth()+"/"+date.getDate()+"/"+date.getFullYear();}
if(indicator==2){var nextMonth=date.getMonth()+2;document.getElementById('AppointmentDate').value=nextMonth+"/"+date.getDate()+"/"+date.getFullYear();}
document.forms['rescheduleAppointment'].method="get";document.forms["rescheduleAppointment"].submit();}
function fn_GetDayAppointmentDayView(indicator){var date=new Date(document.getElementById('AppointmentDate').value);window.name="mySelf";document.forms['dayAppointment'].target="mySelf";var currentMonth=date.getMonth()+1;if(indicator==1){var nextDay=date.getDate()-1;document.getElementById('AppointmentDate').value=currentMonth+"/"+nextDay+"/"+date.getFullYear();}
if(indicator==2){var nextDay=date.getDate()+1;document.getElementById('AppointmentDate').value=currentMonth+"/"+nextDay+"/"+date.getFullYear();}
document.forms['dayAppointment'].method="get";document.forms["dayAppointment"].submit();}
function fn_GetMonthAppointmentDayView(indicator){var date=new Date(document.getElementById('AppointmentDate').value);window.name="mySelf";document.forms['dayAppointment'].target="mySelf";if(indicator==1){document.getElementById('AppointmentDate').value=date.getMonth()+"/"+date.getDate()+"/"+date.getFullYear();}
if(indicator==2){var nextMonth=date.getMonth()+2;document.getElementById('AppointmentDate').value=nextMonth+"/"+date.getDate()+"/"+date.getFullYear();}
document.forms['dayAppointment'].method="get";document.forms["dayAppointment"].submit();}
function fn_updateDateOfAppointment(timeOfAppointment,appointmentDate){if(CkDateValue(appointmentDate,'mm/dd/yyyy')){document.getElementById('dateOfAppointment').value=appointmentDate;document.getElementById('timeOfAppointment').value=timeOfAppointment;}}
function fn_GetMonthView(indicator){var date=new Date(document.getElementById('AppointmentDate').value);if(indicator==1){document.getElementById('AppointmentDate').value=date.getMonth()+"/"+date.getDate()+"/"+date.getFullYear();document.forms["takeAppointment"].submit();}
if(indicator==2){var nextMonth=date.getMonth()+2;document.getElementById('AppointmentDate').value=nextMonth+"/"+date.getDate()+"/"+date.getFullYear();document.forms["takeAppointment"].submit();}}
function fn_GetYearView(indicator){var date=new Date(document.getElementById('AppointmentDate').value);var month=date.getMonth()+1;if(indicator==1){var prevYear=date.getFullYear()-1;document.getElementById('AppointmentDate').value=month+"/"+date.getDate()+"/"+prevYear;document.forms["takeAppointment"].submit();}
if(indicator==2){var nextYear=date.getFullYear()+1;document.getElementById('AppointmentDate').value=month+"/"+date.getDate()+"/"+nextYear;document.forms["takeAppointment"].submit();}}
function fn_openAppointment(){var personID=document.getElementById('PersonID').value;var appointmentDate=document.getElementById('AppointmentDateR').value;var appointmentID=document.getElementById('AppointmentID').value;var timeOfAppointment=document.getElementById('TimeOfAppointment').value;var UserName=document.getElementById('UserName').value;window.name="Parent";var myObject=new Object();myObject.URL='/dayAppointment.htm';var WinSettings='help:0;center:yes;resizable:yes;dialogHeight:400px;dialogWidth:670px;status:no;edge:sunken';var c=window.showModalDialog('/updateAppointment.htm?PersonID='+personID+"&AppointmentDate="+appointmentDate+"&AppointmentTime="+timeOfAppointment+"&AppointmentID="+appointmentID+"&UserName="+UserName,myObject,WinSettings);}
function fn_openAppointmentInbox(personID,appointmentDate,appointmentID,timeOfAppointment){window.name="Parent";var myObject=new Object();myObject.URL='inbox.htm';var WinSettings='help:0;center:yes;resizable:yes;dialogHeight:400px;dialogWidth:670px;status:no;edge:sunken';var c=window.showModalDialog('/updateAppointment.htm?PersonID='+personID+"&AppointmentDate="+appointmentDate+"&AppointmentTime="+timeOfAppointment+"&AppointmentID="+appointmentID,myObject,WinSettings);}
function fn_rescheduleAppointment(){window.name="Parent";var personID=document.getElementById('PersonID').value;var appointmentDate=document.getElementById('AppointmentDateR').value;var appointmentID=document.getElementById('AppointmentID').value;var timeOfAppointment=document.getElementById('TimeOfAppointment').value;var UserName=document.getElementById('UserName').value;var WinSettings='scroll:no;help:0;center:yes;resizable:yes;dialogHeight:630px;dialogWidth:1000px;status:no;edge:sunken';var c=window.showModalDialog('/rescheduleAppointment.htm?PersonID='+personID+"&AppointmentDate="+appointmentDate+"&AppointmentTime="+timeOfAppointment+"&AppointmentID="+appointmentID+"&UserName="+UserName,window,WinSettings);}
function fn_Print(){window.open("about:blank","reportWindow");document.forms['updateAppointment'].target="reportWindow";document.forms['updateAppointment'].method="post";document.forms['updateAppointment'].action="simpleReportCompile.pdf";document.forms['updateAppointment'].submit();}
function fn_confirmAppointment(){document.forms['updateAppointment'].target="Parent";if(firstSubmit==0){document.forms['updateAppointment'].method="post";document.forms['updateAppointment'].submit();firstSubmit=1;setTimeout(fn_confirmAppointment,2000);}else{var oMyObject=window.dialogArguments;document.forms['updateAppointment'].method="get";document.forms['updateAppointment'].action=oMyObject.URL;document.forms['updateAppointment'].submit();firstSubmit=0;self.close();}}
function fn_deletePrescription(num){var elSel=document.getElementById("diagnosis["+num+"].prescriptionList");var i;for(i=elSel.length-1;i>=0;i--){if(elSel.options[i].selected){elSel.remove(i);}}}
function fn_deleteTest(num){var elSel=document.getElementById("diagnosis["+num+"].testList");var i;for(i=elSel.length-1;i>=0;i--){if(elSel.options[i].selected){elSel.remove(i);}}}
function fn_updateAppointmentDetails(){var num=(document.getElementById("counter").value-2)+1;for(var j=0;j<num;j++){var elSel=document.getElementById("diagnosis["+j+"].prescriptionList");var i;for(i=elSel.length-1;i>=0;i--){elSel.options[i].selected=true;}
var elSel=document.getElementById("diagnosis["+j+"].testList");var i;for(i=elSel.length-1;i>=0;i--){elSel.options[i].selected=true;}}
document.forms['updateAppointment'].target="Parent";document.forms["updateAppointment"].submit();document.forms['updateAppointment'].method="get";document.forms['updateAppointment'].action="dayAppointment.htm";document.forms['updateAppointment'].submit();self.close();}
function fn_addToSelect(selectName,tempName){if(document.getElementById(tempName).value==""){alert("Please enter the text to be added.");document.getElementById(tempName).focus();}else{var opt=document.createElement("OPTION");document.getElementById(selectName).options.add(opt);opt.text=document.getElementById(tempName).value;opt.value=document.getElementById(tempName).value;opt.selected="true";document.getElementById(tempName).value="";document.getElementById(tempName).focus();}}
function addRowToTable()
{var numi=document.getElementById('counter');var num=(document.getElementById("counter").value-1)+2-1;numi.value=num;var tbl=document.getElementById('tblSample');var lastRow=tbl.rows.length;var iteration=lastRow;var row=tbl.insertRow(lastRow);var cellRight=row.insertCell(0);var el=document.createElement('input');el.type='checkbox';cellRight.appendChild(el);var cellLeft=row.insertCell(1);var el0=document.createElement('input');el0.type='text';el0.name="diagnosis["+(num-1)+"].codeICD";el0.id="diagnosis["+(num-1)+"].codeICD";el0.size=20;cellLeft.appendChild(el0);var ss=document.createElement('script');var scr="new Autocomplete('"+el0.name+"', { serviceUrl:'/appointmentPopUp.htm' },'table.DIAGNOSIS');";ss.text=scr;var hh=document.getElementsByTagName('head')[0];hh.appendChild(ss);var cellRight=row.insertCell(2);var el=document.createElement('input');el.type='text';el.name='findPrescription['+(num-1)+']';var pr=el.name;el.id='findPrescription['+(num-1)+']';el.size=20;cellRight.appendChild(el);var ss=document.createElement('script');var scr="new Autocomplete('"+el.name+"', { serviceUrl:'/appointmentPopUp.htm' },'table.PRESCRIPTION');";ss.text=scr;var hh=document.getElementsByTagName('head')[0];hh.appendChild(ss);var cellRight=row.insertCell(3);var el=document.createElement('input');el.type='button';el.value='>>';el.name='btnAdd'+iteration;el.id='btnAdd'+iteration;el.setAttribute("class","bsubmit");var selName="diagnosis["+(num-1)+"].prescriptionList";el.onclick=function(){fn_addToSelect(selName,pr)};el.className='bsubmit';cellRight.appendChild(el);cellRight.appendChild(document.createElement("br"));var el=document.createElement('input');el.type='button';el.value='<<';el.name='btnDel'+iteration;el.id='btnDdd'+iteration;el.setAttribute("class","bsubmit");el.onclick=function(){fn_deletePrescription(num-1);};el.className='bsubmit';cellRight.appendChild(el);var cellRightSel=row.insertCell(4);var sel=document.createElement('<select multiple size=3 style="width: 15em">');sel.name="diagnosis["+(num-1)+"].prescriptionList";sel.id="diagnosis["+(num-1)+"].prescriptionList";el.size=3;cellRightSel.appendChild(sel);var cellRight=row.insertCell(5);var el=document.createElement('input');el.type='text';el.name='findTest['+(num-1)+']';var pr1=el.name;el.id='findTest['+(num-1)+']';testName='findTest['+(num-1)+']';el.size=20;cellRight.appendChild(el);var ss=document.createElement('script');var scr="new Autocomplete('"+el.name+"', { serviceUrl:'/appointmentPopUp.htm' },'table.TEST');";ss.text=scr;var hh=document.getElementsByTagName('head')[0];hh.appendChild(ss);var cellRight=row.insertCell(6);var el=document.createElement('input');el.type='button';el.value='>>';el.name='btnAdd'+iteration;el.id='btnAdd'+iteration;el.setAttribute("class","bsubmit");var selName1="diagnosis["+(num-1)+"].testList";el.onclick=function(){fn_addToSelect(selName1,pr1)};testNames="diagnosis["+(num-1)+"].testList";el.className='bsubmit';cellRight.appendChild(el);cellRight.appendChild(document.createElement("br"));var el=document.createElement('input');el.type='button';el.value='<<';el.name='btnDel'+iteration;el.id='btnDel'+iteration;el.setAttribute("class","bsubmit");el.onclick=function(){fn_deleteTest(num-1);};el.className='bsubmit';cellRight.appendChild(el);var cellRightSel=row.insertCell(7);var sel=document.createElement("<select multiple size=3 style='width: 15em'>");sel.name="diagnosis["+(num-1)+"].testList";sel.id="diagnosis["+(num-1)+"].testList";el.size=3;cellRightSel.appendChild(sel);num=num+1;document.getElementById("counter").value=num;}
function removeRowFromTable()
{var tbl=document.getElementById('tblSample');var lastRow=tbl.rows.length;if(lastRow>2)tbl.deleteRow(lastRow-1);var num=(document.getElementById("counter").value-2)+1;document.getElementById("counter").value=num;}
function deleteRow(tableID,form){var table=document.getElementById(tableID);var totalChkBoxs=form.deleteChk.length;for(var i=0;i<totalChkBoxs;i++){var row=table.rows[i+1];if(null!=form.deleteChk&&true==form.deleteChk[i].checked){table.deleteRow(i+2);totalChkBoxs=totalChkBoxs-1;}}}
function fn_uploadFile(){window.name="ParentWindow";var WinSettings='help:0;center:yes;resizable:yes;dialogHeight:300px;dialogWidth:700px;status:no;edge:sunken';var c=window.showModalDialog('/uploadFile.htm',window,WinSettings);}
function fn_deleteAllergy(){var elSel=document.getElementById('allergies');var i;for(i=elSel.length-1;i>=0;i--){if(elSel.options[i].selected){elSel.remove(i);}}}
function fn_saveHistory(){var elSel=document.getElementById('allergies');var i;for(i=elSel.length-1;i>=0;i--){elSel.options[i].selected=true;}
document.forms['pastHistory'].submit();}
function fn_uploadSelectedFile(){document.forms['uploadFile'].target="ParentWindow";document.forms["uploadFile"].submit();self.close();}
function fn_addRowForWorkHours()
{if((document.getElementById('sundayWorking').checked==true||document.getElementById('mondayWorking').checked==true||document.getElementById('tuesdayWorking').checked==true||document.getElementById('wednesdayWorking').checked==true||document.getElementById('thursdayWorking').checked==true||document.getElementById('fridayWorking').checked==true||document.getElementById('saturdayWorking').checked==true)&&document.getElementById('startTime').value!=""&&document.getElementById('endTime').value!="")
{if(document.getElementById('sundayWorking').checked==true){fn_addRowForTime("Sunday");}
if(document.getElementById('mondayWorking').checked==true){fn_addRowForTime("Monday");}
if(document.getElementById('tuesdayWorking').checked==true){fn_addRowForTime("Tuesday");}
if(document.getElementById('wednesdayWorking').checked==true){fn_addRowForTime("Wednesday");}
if(document.getElementById('thursdayWorking').checked==true){fn_addRowForTime("Thursday");}
if(document.getElementById('fridayWorking').checked==true){fn_addRowForTime("Friday");}
if(document.getElementById('saturdayWorking').checked==true){fn_addRowForTime("Saturday");}}else{if(document.getElementById('sundayWorking').checked==false&document.getElementById('mondayWorking').checked==false&document.getElementById('tuesdayWorking').checked==false&document.getElementById('wednesdayWorking').checked==false&document.getElementById('thursdayWorking').checked==false&document.getElementById('fridayWorking').checked==false&document.getElementById('saturdayWorking').checked==false){alert("Please select day.");}
if(document.getElementById('startTime').value==""){alert("Please enter start time.");}
if(document.getElementById('endTime').value==""){alert("Please enter end time.");}}
var numi=document.getElementById('counter').value;var num=(document.getElementById("counter").value-1)+1-1;}
function fn_addRowForTime(dayName){var numi=document.getElementById('counter');var num=(document.getElementById("counter").value-1)+1;var tbl=document.getElementById('tblWorkHours');var lastRow=tbl.rows.length;if(numi.value==1){document.getElementById("doctorWorkTiming[0].workDayName").readonly=false;document.getElementById("doctorWorkTiming[0].workDayName").size=10;document.getElementById("doctorWorkTiming[0].workDayName").value=dayName;document.getElementById("doctorWorkTiming[0].startTime").value=document.getElementById("startTime").value;document.getElementById("doctorWorkTiming[0].startTime").size=10;document.getElementById("doctorWorkTiming[0].endTime").value=document.getElementById("endTime").value;document.getElementById("doctorWorkTiming[0].endTime").size=10;}else{var iteration=lastRow;var row=tbl.insertRow(lastRow);var cellLeft=row.insertCell(0);var el0=document.createElement('input');el0.type='text';el0.name="doctorWorkTiming["+(num-1)+"].workDayName";el0.id="doctorWorkTiming["+(num-1)+"].workDayName";el0.size=10;cellLeft.appendChild(el0);document.getElementById(el0.id).readonly=true;document.getElementById(el0.id).value=dayName;var lowercaseDayName=dayName.toLowerCase();document.getElementById("doctorDetails."+lowercaseDayName+"Working").value="Y";var cellLeft=row.insertCell(1);var el0=document.createElement('input');el0.type='text';el0.name="doctorWorkTiming["+(num-1)+"].startTime";el0.id="doctorWorkTiming["+(num-1)+"].startTime";el0.size=10;cellLeft.appendChild(el0);document.getElementById(el0.id).readonly=true;document.getElementById(el0.id).value=document.getElementById("startTime").value;var cellLeft=row.insertCell(2);var el0=document.createElement('input');el0.type='text';el0.name="doctorWorkTiming["+(num-1)+"].endTime";el0.id="doctorWorkTiming["+(num-1)+"].endTime";el0.size=10;cellLeft.appendChild(el0);document.getElementById(el0.id).readonly=true;document.getElementById(el0.id).value=document.getElementById("endTime").value;}
numi.value=num+1;}
function saveProfile(){var numi=document.getElementById('counter');var num=(document.getElementById("counter").value-1)+1-1;numi.value=num;document.forms["personalProfile"].submit();}
function fn_UpdateAppointment(appointmentID){document.getElementById('AppointmentID').value=appointmentID;document.forms["dayAppointment"].submit();}
function check_date(field){var checkstr="0123456789";var DateField=field;var Datevalue="";var DateTemp="";var seperator="/";var day;var month;var year;var leap=0;var err=0;var i;err=0;DateValue=DateField.value;for(i=0;i<DateValue.length;i++){if(checkstr.indexOf(DateValue.substr(i,1))>=0){DateTemp=DateTemp+DateValue.substr(i,1);}}
DateValue=DateTemp;if(DateValue.length==6){DateValue=DateValue.substr(0,4)+'20'+DateValue.substr(4,2);}
if(DateValue.length!=8){err=19;}
year=DateValue.substr(4,4);if(year==0){err=20;}
month=DateValue.substr(0,2);if((month<1)||(month>12)){err=21;}
day=DateValue.substr(2,2);if(day<1){err=22;}
if((year%4==0)||(year%100==0)||(year%400==0)){leap=1;}
if((month==2)&&(leap==1)&&(day>29)){err=23;}
if((month==2)&&(leap!=1)&&(day>28)){err=24;}
if((day>31)&&((month=="01")||(month=="03")||(month=="05")||(month=="07")||(month=="08")||(month=="10")||(month=="12"))){err=25;}
if((day>30)&&((month=="04")||(month=="06")||(month=="09")||(month=="11"))){err=26;}
if((day==0)&&(month==0)&&(year==00)){err=0;day="";month="";year="";seperator="";}
if(err==0){DateField.value=month+seperator+day+seperator+year;}
else{alert("Date is incorrect!");DateField.select();DateField.focus();}}
function addRowToCalendar()
{document.getElementById('AddOperation').value="Y";holidayCalendar.method="post";holidayCalendar.submit();}
function fn_updateHolidayCalendar(){document.getElementById('AddOperation').value="N";holidayCalendar.method="post";holidayCalendar.submit();}
function removeRowFromCalendar()
{var tbl=document.getElementById('tblSample');var lastRow=tbl.rows.length;if(lastRow>2)tbl.deleteRow(lastRow-1);}
var dDate=new Date();var dCurMonth=dDate.getMonth();var dCurDayOfMonth=dDate.getDate();var dCurYear=dDate.getFullYear();var objPrevElement=new Object();function fToggleColor(myElement){var toggleColor="#ff0000";if(myElement.id=="calDateText"){if(myElement.color==toggleColor){myElement.color="";}else{myElement.color=toggleColor;}}else if(myElement.id=="calCell"){for(var i in myElement.children){if(myElement.children[i].id=="calDateText"){if(myElement.children[i].color==toggleColor){myElement.children[i].color="";}else{myElement.children[i].color=toggleColor;}}}}}
function fSetSelectedDay(myElement){if(myElement.id=="calCell"){if(!isNaN(parseInt(myElement.children["calDateText"].innerText))){myElement.bgColor="#c0c0c0";objPrevElement.bgColor="";document.all.calSelectedDate.value=parseInt(myElement.children["calDateText"].innerText);objPrevElement=myElement;document.all("selectedDate").value=myElement.children["calDateText"].innerText;document.all("selectedMonth").value=document.all("tbSelMonth").value;document.all("selectedYear").value=document.all("tbSelYear").value;window.location.href="/dayAppointment.htm?selectedDate="+myElement.children["calDateText"].innerText+"&selectedMpnth="+document.all("tbSelMonth").value+"&selectedYear="+document.all("tbSelYear").value;}}}
function getAppointment(personID,appointmentDate){window.location.href="/dayAppointment.htm?PersonID="+personID+"&AppointmentDate="+appointmentDate;}
function fn_moveDiv(event){x=event.clientX;y=event.clientY;document.getElementById('TestResult').style.top=y+'px';document.getElementById('TestResult').style.left=x+'px';document.getElementById('TestResult').style.display="block";}
function fGetDaysInMonth(iMonth,iYear){var dPrevDate=new Date(iYear,iMonth,0);return dPrevDate.getDate();}
function fBuildCal(iYear,iMonth,iDayStyle){var aMonth=new Array();aMonth[0]=new Array(7);aMonth[1]=new Array(7);aMonth[2]=new Array(7);aMonth[3]=new Array(7);aMonth[4]=new Array(7);aMonth[5]=new Array(7);aMonth[6]=new Array(7);var dCalDate=new Date(iYear,iMonth-1,1);var iDayOfFirst=dCalDate.getDay();var iDaysInMonth=fGetDaysInMonth(iMonth,iYear);var iVarDate=1;var i,d,w;if(iDayStyle==2){aMonth[0][0]="Sunday";aMonth[0][1]="Monday";aMonth[0][2]="Tuesday";aMonth[0][3]="Wednesday";aMonth[0][4]="Thursday";aMonth[0][5]="Friday";aMonth[0][6]="Saturday";}else if(iDayStyle==1){aMonth[0][0]="Sun";aMonth[0][1]="Mon";aMonth[0][2]="Tue";aMonth[0][3]="Wed";aMonth[0][4]="Thu";aMonth[0][5]="Fri";aMonth[0][6]="Sat";}else{aMonth[0][0]="Su";aMonth[0][1]="Mo";aMonth[0][2]="Tu";aMonth[0][3]="We";aMonth[0][4]="Th";aMonth[0][5]="Fr";aMonth[0][6]="Sa";}
for(d=iDayOfFirst;d<7;d++){aMonth[1][d]=iVarDate;iVarDate++;}
for(w=2;w<7;w++){for(d=0;d<7;d++){if(iVarDate<=iDaysInMonth){aMonth[w][d]=iVarDate;iVarDate++;}}}
return aMonth;}
function fDrawCal(iYear,iMonth,iCellWidth,iCellHeight,sDateTextSize,sDateTextWeight,iDayStyle){var myMonth;myMonth=fBuildCal(iYear,iMonth,iDayStyle);document.write("<table border='1'>")
document.write("<tr>");document.write("<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>"+myMonth[0][0]+"</td>");document.write("<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>"+myMonth[0][1]+"</td>");document.write("<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>"+myMonth[0][2]+"</td>");document.write("<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>"+myMonth[0][3]+"</td>");document.write("<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>"+myMonth[0][4]+"</td>");document.write("<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>"+myMonth[0][5]+"</td>");document.write("<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>"+myMonth[0][6]+"</td>");document.write("</tr>");for(w=1;w<7;w++){document.write("<tr>")
for(d=0;d<7;d++){document.write("<td align='left' valign='top' width='"+iCellWidth+"' height='"+iCellHeight+"' id=calCell style='CURSOR:Hand' onMouseOver='fToggleColor(this)' onMouseOut='fToggleColor(this)' onclick=fSetSelectedDay(this)>");if(!isNaN(myMonth[w][d])){document.write("<font id=calDateText onMouseOver='fToggleColor(this)' style='CURSOR:Hand;FONT-FAMILY:Arial;FONT-SIZE:"+sDateTextSize+";FONT-WEIGHT:"+sDateTextWeight+"' onMouseOut='fToggleColor(this)' onclick=fSetSelectedDay(this)>"+myMonth[w][d]+"</font>");}else{document.write("<font id=calDateText onMouseOver='fToggleColor(this)' style='CURSOR:Hand;FONT-FAMILY:Arial;FONT-SIZE:"+sDateTextSize+";FONT-WEIGHT:"+sDateTextWeight+"' onMouseOut='fToggleColor(this)' onclick=fSetSelectedDay(this)> </font>");}
document.write("</td>")}
document.write("</tr>");}
document.write("</table>")}
function fUpdateCal(iYear,iMonth){myMonth=fBuildCal(iYear,iMonth);objPrevElement.bgColor="";document.all.calSelectedDate.value="";for(w=1;w<7;w++){for(d=0;d<7;d++){if(!isNaN(myMonth[w][d])){calDateText[((7*w)+d)-7].innerText=myMonth[w][d];}else{calDateText[((7*w)+d)-7].innerText=" ";}}}}
function fn_showReminder(){if(document.buttonimgdown.src==eval('cacheoffimgdown.src')){document.buttonimgdown.src=eval('cacheonimgdown.src');document.getElementById('remindme').style.display='block';}else{document.buttonimgdown.src=eval('cacheoffimgdown.src');document.getElementById('remindme').style.display='none';}}
function fn_showMyReminder(){if(document.buttonimgdownM.src==eval('cacheoffimgdownM.src')){document.buttonimgdownM.src=eval('cacheonimgdownM.src');document.getElementById('remindMy').style.display='block';}else{document.buttonimgdownM.src=eval('cacheoffimgdownM.src');document.getElementById('remindMy').style.display='none';}}
function fn_confirmIt(){if(document.buttonimgdown1.src==eval('cacheoffimgdown1.src')){document.buttonimgdown1.src=eval('cacheonimgdown1.src');document.getElementById('confirmit').style.display='block';}else{document.buttonimgdown1.src=eval('cacheoffimgdown1.src');document.getElementById('confirmit').style.display='none';}}
function showbox(a){var e=event||window.event;if(!e)
var e=window.event;var linkID=e.srcElement?e.srcElement.id:this.id;var helpbox=document.getElementById('helpbox');helpbox.innerHTML='<b>Click here...</b><br>'+a;helpbox.style.display='block';var posx=(typeof e.pageX!='undefined')?e.pageX:e.clientX+(document.documentElement?document.documentElement.scrollLeft:document.body.scrollLeft);var posy=(typeof e.pageY!='undefined')?e.pageY:e.clientY+(document.documentElement?document.documentElement.scrollTop:document.body.scrollTop);<!--set x-axis and y-axis position for displaying helpbox/tipbox here-->helpbox.style.top=posy+'px';helpbox.style.left=posx+'px';}<!--code for hidding helpbox-->function hidebox(){document.getElementById('helpbox').style.display='none';}